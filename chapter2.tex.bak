\chapter{ОПТИМАЛЬНОЕ УПРАВЛЕНИЕ ДИНАМИЧЕСКИМИ СИСТЕМАМИ ПО НЕПОЛНЫМ И НЕТОЧНЫМ ИЗМЕРЕНИЯМ}\label{chap2}


В данной главе формулируется задача оптимального гарантированного управления для линейной нестационарной системы с неизвестным начальным состоянием. Указаны цели управления и приводятся основные понятия и определения.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Постановка задачи} \label{2sec:problem-formulation}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
На промежутке времени  $T = [t_0,t_f]$, рассмотрим линейную
нестационарную систему управления с возмущением:
\begin{equation}
    \dot{x} = A(t)x+B(t){u}, \ x(t_0) = x_0,
    \end{equation}
где $t\in T$\\
$x=x(t) \in \mathbb{R}^n$ --- состояние системы (2.1) в момент времени $t$;\\
$u=u(t) \in \mathbb{U}^r$ --- значение управляющего воздействия в момент $t$;\\
$U \subseteq \mathbb{R}^r$ --- ограниченное множество его доступных значений\\
$A(t)\in\mathbb{R}^{n\times n}$, $B(t)\in\mathbb{R}^{n\times r}$ --- заданные кусочно-непрерывные матричные и векторная функции.


%Будем полагать, что возмущение кусочно-непрерывно и ограничено. Поскольку возмущение скалярно, примем, что его значения ограничены по модулю: $|w(t)|\le w^*$, $t\in T$.
Начальное состояние $x(t_0) = x_0$ динамической системы (2.1) считается неизвестным. Однако известна некоторая простая оценка начального состояния. Эта оценка задается включением
$$
    x(t_0) \in X_0 \subset\mathbb{R}^n.
    $$

\begin{definition}
Множество возможных значений начального состояния $X_0\subset\mathbb{R}^n$ называется априорным распределением начального состояния.
\end{definition}

Как правило, $X_0$ --- некоторое простое множество, например параллелепипед: $X_0 = \{x\in \mathbb{R}^n : x_*\le x\le x*\}$.

Недетерминированной системе (2.1) соответствует детерминированная система вида
\begin{equation}
    \dot{x} = A(t)x+B(t){u}, \ x(t_0) = 0,
    \end{equation}
которая в некоторой литературе также называется номинальной системой.


Управление системой будем осуществлять с помощью дискретных управлений с периодом квантования $h$ (см. главу 1).

Обозначим цели управления. Таких целей будет две:
\begin{itemize}
\item[1)] перевод системы (2.1) с гарантией на заданное терминальное множество
$$
    S = \{x\in\mathbb{R}^n : h_i'x\leq g_i, \ i = \overline{1,m} \};
    $$
\item[2)] минимизация гарантированного значения терминального критерия качества
$$
    h_0'x(t_f).
    $$
\end{itemize}

Здесь термин "с гарантией"\ означает что включение $x(t_f)\in S$ должно выполняться для любых возможных в силу неопределённости терминальных состояний системы (2.1).

Пусть, как и ранее, $x(t_f\mid t_0,x_0,u(\cdot))$ --- траектория системы (2.1), стартующая в момент $t_0$ из начального состояния $x_0 \in X_0$ под действием управления   $u(\cdot)=(u(t),t\in[t_0,t_f])$.

Перевод системы (2.1) на терминальное множество $S$ с гарантией означает выполнение условия
\begin{equation}
x(t_f\mid t_0,x_0,u(\cdot))\in S, \ \forall\  x_0\in X_0.
\end{equation}

Под "гарантированным значением"\ критерия качества понимается минимальное значение терминального функционала $h_0'x(t_f)$ при наихудшей реализации неопределённости (начального состояния):
$$
    J(u\mid{t_0},X_0) = \max_{x_0\in{X_0}}h_0'x(t_f\mid t_0,x_0,u(\cdot));
    $$
$$
    J(t_0,X_0)=\min_{u}J(u\mid{t_0},X_0) =\min_{u}\max_{x_0\in{X_0}}h_0'x(t_f\mid t_0,x_0,u(\cdot)).
    $$
Значение $J(t_0,X_0)$ дает априорную оценку качества управления системой (2.1).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Оптимальная гарантирующая программа}\label{2sec:problem-formulation}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


До начала процесса управления мы обладаем только информацией о априорной оценке начального состояния --- множестве $X_0$. На её основе можно спрогнозировать поведение системы в будущем и предложить оптимальную   (априорную) программу $u^0(\cdot) = u^0(\cdot\mid t_0,X_0)$, выполняющую цель управления.

\begin{definition}
Управление $u(t)\in U$, $t\in[t_0,t_f]$, называется (априорной) программой, если на нем выполняется условие (2.3). Программа $u^0(t)$, $t\in[t_0,t_f]$, --- оптимальная, если
$$
    J(u^0\mid{t_0},X_0)= \min{J(u\mid{t_0},X_0)},
    $$
где минимум ищется среди всех программ.
\end{definition}

Априорная неопределённость начального состояния $X_0$ порождает неопределённость движения рассматриваемого динамического объекта, которую при заданной функции управления $u(\cdot)$ можно описать с помощью формулы Коши:
$$
    X(t) = F(t,t_0)X_0 +\Large \displaystyle \int\limits_{t_0}^t F(t,\vartheta)B(\vartheta)u(\vartheta)d\vartheta,
    $$
где $F(t,\vartheta)$ --- фундаментальная матрица однородного дифференциального уравнения $\dot x = A(t)x$, $t\in T$.

В любой момент времени $t\in T$ текущее состояние системы (2.1) содержится в множестве $X(t)\subset \mathbb{R}^n$ и никакое $x\notin X(t)$ не может быть достигнуто в данной системе.

Переформулируем теперь цели управления:
\begin{itemize}
\item[1)] выполнение включения
$$
    X(t_f)\subset S,
    $$
\item[2)] минимизация по $u$ гарантированного значения критерия качества
$$
    J(u\mid{t_0},X_0) =\max_{x\in{X(t_f)}}h_0'x.
    $$
\end{itemize}

\begin{definition}
Дискретная функция $u(\cdot)$, удовлетворяющая
ограничению $u(t) \in U$, $t\in T$, называется гарантирующей программой (программным гарантирующим управляющим воздействием), если выполняется включение $X(t_f)\subset S$.
\end{definition}

\begin{definition}
Оптимальная гарантирующая программа $u(\cdot)$ --- такая гарантирующая программа, на которой критерий качества достигает минимального значения
$$
    J(u^0)= \min_{u}{J(u\mid{t_0},X_0)},
    $$
где минимум ищется среди всех гарантирующих программ, определенных
согласно определению 2.3.
 \end{definition}
 
Рассмотрим $i$-ое терминальное ограничение $h'_ix(t_f)\le g_i$. При заданном управлении $u(\cdot)$ оно будет выполняться при всех $x_0\in X_0$ тогда и только тогда,когда
\begin{equation}
\max_{x_0\in{X_0}}h'_ix(t_f\mid t_0,x_0,u(\cdot))\le g_i,
\end{equation}
т.е. при выполнении неравенства
\begin{equation}
\max_{x_0\in{X_0}}h'_iF(t_f,t_0)x_0 + \displaystyle \int\limits_{t_0}^{t_f} h'_iF(t_f,\vartheta)B(\vartheta)u(\vartheta)d\vartheta \le g_i.
\label{5problem}
\end{equation}

Введём обозначения:
\begin{equation}
 g_i(t_0) = g_i- \max_{x_0\in{X_0}}h_iF(t_f,t_0)x_0,i = \overline{1,m} .
\end{equation}

Тогда (\ref{5problem}) примет вид:
\begin{equation}
\displaystyle\int\limits_{t_0}^{t_f}h'_iF(t_f,\vartheta)B(\vartheta)u(\vartheta)d\vartheta\le g_i(t_0).
\label{7problem}
\end{equation}

Условие (\ref{7problem}) допустимости управления $u(\cdot)$ можно сформулировать в динамической форме: для того, чтобы управления было программой необходимо и достаточно, чтобы оно переводило в момент детерминированную систему
\begin{equation}
\dot{x_0} = A(t)x+B(t){u}, \ x(t_0) = 0,
\end{equation}
на множество $S(t_0) = {x\in\mathbb{R}^n:h'_ix\le g(t_0),i = \overline{1,m}}$

Качество априорной программы $u(\cdot)$ оценивается значением
\begin{equation}
J(u\mid t_0,X_0) =  \max_{x_0\in{X_0}}h'_0x(t_f\mid t_0,x_0,u(\cdot))
\end{equation}

Тогда
\begin{equation}
    J(u\mid t_0,X_0) = \max_{x_0\in{X_0}}h'_0F(t_f,t_0)x_0 + \displaystyle\int\limits_{t_0}^{t_f}h'_0F(t_f,\vartheta)B(\vartheta)u(\vartheta)d\vartheta
\end{equation}
Следовательно, оптимальная программа $u^0(t), t\in[t_0,t_f]$, является решением задачи
 \begin{equation}
   h'_0x_0(t_f) \to \min,
   \label{9problem}
\end{equation}
$$\dot{x_0} = A(t)x_0+B(t){u}, \ x_0(t_0) = 0,
$$
$$x_0(t_f)\in S(t_0), u(t)\in U, t\in [t_0,t_f],$$
при этом
$$ J(u_0\mid t_0,X_0) = \max_{x_0\in{X_0}}h'_0F(t_f,t_0)x_0+ h'_0x_0(t_f) $$
где $x^0_0(\cdot)$--- оптимальная траектория задачи (\ref{9problem})

Далее будем предполагать, что оптимальная априорная программа $u^0(\cdot)$ существует.

Стоит заметить, что оптимальная априорная программа сильно недооценивает потенциал управляемой системы и даёт очень консервативные оценки критерия качества. 